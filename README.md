# Drom.ru linear regression model

Модели линейной регрессии для задачи предсказания цены авто на основе города продажи и пробега.

## Описание проекта

Данный проект решает задачу предсказания цены авто Toyota Prius XV30 рестайлинг, основываясь на информации о городе продажи (Хабаровск, Владивосток или Благовещенск) а также пробеге автомобиля.
Модели обучаются на датасете, полученном в результате парсинга страниц сайта drom.ru.

## Структура проекта

```
drom_linear_regression_model/
├── venv/                             # Корневая папка виртуального окружения
│ 
├── configs/                          # Конфигурационные файлы
│   
├── data/                             # Датасет
│   
├── logs/                             # Файлы логов
│   
├── models/                           # Файлы pickle обученных моделей
│    
├── utils/                            # Модули для построения пайплайна
│   
├── data_pipeline.py                  # Скрипт etl пайплайна для создания датасета
│   
├── linear_regression__pipeline.py    # Скрипт пайплайна обучения моделей линейной регрессии
│ 
├── app.py                            # Скрипт веб сервиса для расчета цены авто
│ 
├── README.md                         # Документация
│ 
├── .gitignore                        # Файл .gitignore
│ 
└── requirements.txt                  # Файл с модулями для установки
```

## Установка зависимостей
В консоли IDE программы перейдите в корневую папку проекта и активируйте виртуальную среду, если она еще не была активирована.
Введите команду
      ```
      pip install -r requirements.txt
      ``` 
для установки модулей из файла requirements.txt

## Структура конфигурационных файлов модели
В проекте используется конфигурационный файл пайплайна, находящиеся в папке configs:

### 'project_config.yaml'
Ниже будет представлено описание ключей и значений .yaml словаря в формате "ключ: тип данных (диапазон значений) - описание"
 - "output_dir_for_data": str - путь к директории для сохранения предобработанного датасета
 - "class_name": str - имя класса html тегов для парсинга
 - "url_dict": dict - словарь, ключи которого коды городов (khv, vdk, blg), а значения - строки веб страниц сайта drom.ru с автомобилями toyota prius XV30 рестайлинг в этих городах
 - "headers": dict - словарь заголовков для HTTP запроса с ключами Accept и User-Agent


## Работа с проектом
1. Для запуска ETL пайплайна обработки данных перейдите в корневую папку с проектом и введите команду:
      ``` 
      python run data_pipeline.py
      ``` 

    После успешного завершения работы пайплайна предобработанный датасет будет сохранен в папке data с именем `annotated_data.csv`.


2. Для запуска пайплайна обучения модели линейной регрессии перейдите в корневую папку с проектом и введите команду: 
      ``` 
      python run linear_regression_pipeline.py
      ``` 
   После успешного завершения работы пайплайна обученная модель будет сохранена в папке models.


3. Для запуска веб сервиса перейдите в папку utils `cd utils` и введите команду: 
      ``` 
      uvicorn service:app
      ```
   
    После этого откройте еще одно окно терминала, перейдите в корневую папку с проектом и введите команду `streamlit run app.py`.
    Веб страница откроется автоматически в вашем браузере.

